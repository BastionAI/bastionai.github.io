<style>
.multi-head-container {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 24px;
    margin: 2em 0;
    background-color: #f9fafb;
}
.multi-head-sentence {
    font-size: 1.5em;
    font-weight: 500;
    margin-bottom: 24px;
    padding: 16px;
    border-radius: 8px;
    background-color: #fff;
    border: 1px solid #e5e7eb;
    text-align: center;
    line-height: 2;
}
.multi-head-word {
    transition: all 0.2s ease-in-out;
    padding: 4px;
    border-radius: 4px;
}
.multi-head-controls {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin-bottom: 16px;
}
.multi-head-button {
    background-color: #fff;
    border: 1px solid #d1d5db;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.95em;
    transition: all 0.2s;
}
.multi-head-button:hover {
    background-color: #f3f4f6;
    border-color: #9ca3af;
}
.multi-head-button.active {
    background-color: #3b82f6;
    color: white;
    border-color: #3b82f6;
}
</style>

<div class="multi-head-container" role="region" aria-label="Interactive Multi-Head Attention Visualization">
    <div class="multi-head-sentence" id="multi-head-sentence">
        <!-- Spans will be generated by JS -->
    </div>
    <div class="multi-head-controls">
        <p>Click on a "Specialist Head" to see which aspect of the sentence it focuses on:</p>
        <div id="multi-head-buttons">
            <!-- Buttons will be generated by JS -->
        </div>
    </div>
    <noscript>
        <figure>
            <img src="/assets/images/fallbacks/multi-head-fallback.png" alt="Static diagram of Multi-Head Attention. It shows a sentence with different words highlighted, corresponding to different 'specialist heads' that focus on grammar, pronouns, and concepts respectively." style="max-width: 100%; border-radius: 8px; margin-top: 15px;">
            <figcaption style="font-size: 0.9em; color: #666; margin-top: 5px;">
                Static fallback image. This visualization demonstrates how different 'heads' in the attention mechanism focus on different parts of a sentence to build a complete understanding of context.
            </figcaption>
        </figure>
    </noscript>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const buttons = document.querySelectorAll('.multi-head-button');
    const words = document.querySelectorAll('.multi-head-word');

    const attentionData = {
        grammar: { 'robot': '#bfdbfe', 'picked': '#bfdbfe' },
        pronoun: { 'it': '#bfdbfe', 'ball': '#bfdbfe' },
        concept: { 'picked': '#fee2e2', 'heavy': '#fee2e2' }
    };

    function updateHighlight(head) {
        // Reset all words
        words.forEach(wordEl => {
            wordEl.style.backgroundColor = 'transparent';
        });

        const highlights = attentionData[head];
        for (const word in highlights) {
            const color = highlights[word];
            document.querySelector(`.multi-head-word[data-word="${word}"]`).style.backgroundColor = color;
        }
    }

    buttons.forEach(button => {
        button.addEventListener('click', () => {
            buttons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            const head = button.dataset.head;
            updateHighlight(head);
        });
    });

    // Initial highlight
    updateHighlight('grammar');
});
</script> 